---
title: Introduction à l'API
description: Tout ce qu'il faut savoir pour commencer à utiliser l'API REST DispatchKit.
---

import { Aside } from '@astrojs/starlight/components';

## Introduction à l'API

L'API DispatchKit est une API REST qui retourne des données en JSON. Elle permet d'intégrer toutes les fonctionnalités de la plateforme dans vos outils et systèmes existants.

## Base URL

```
https://api.dispatchkit.io/api/v1
```

Toutes les requêtes doivent utiliser HTTPS. Les requêtes HTTP sont automatiquement redirigées.

## Authentification

L'API utilise des **tokens JWT Bearer**. Obtenez un token en appelant l'endpoint de login, puis incluez-le dans le header `Authorization` de chaque requête.

```bash
curl https://api.dispatchkit.io/api/v1/missions \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIs..."
```

<Aside type="caution">
  Les tokens ont une durée de vie de **24 heures**. Utilisez l'endpoint `/auth/refresh` pour renouveler votre token avant expiration sans redemander les identifiants.
</Aside>

## Format des réponses

Toutes les réponses sont en JSON. Une réponse réussie contient les données directement ou encapsulées dans une clé de ressource.

### Réponse réussie (liste)

Certains endpoints retournent un tableau JSON directement, sans enveloppe ni pagination :

```json
[
  {
    "id": "c3d4e5f6-a7b8-9012-cdef-123456789012",
    "title": "Livraison Rue de la Paix",
    "status": "in_progress",
    ...
  }
]
```

### Réponse réussie (ressource unique)

```json
{
  "id": "c3d4e5f6-a7b8-9012-cdef-123456789012",
  "title": "Livraison Rue de la Paix",
  "status": "in_progress",
  ...
}
```

### Réponse d'erreur

```json
{
  "error": {
    "code": "OPERATOR_NOT_AVAILABLE",
    "message": "L'opérateur sélectionné n'est pas disponible",
    "details": {
      "operator_id": "f1e2d3c4-b5a6-7890-abcd-ef1234567890",
      "current_status": "on_mission"
    }
  }
}
```

## Codes HTTP

| Code | Signification |
|------|---------------|
| `200` | Succès |
| `201` | Ressource créée |
| `204` | Succès sans contenu (DELETE) |
| `400` | Requête invalide (champs manquants ou invalides) |
| `401` | Token manquant ou invalide |
| `403` | Permissions insuffisantes |
| `404` | Ressource introuvable |
| `422` | Données valides mais règle métier violée |
| `429` | Rate limit dépassé |
| `500` | Erreur serveur interne |

## Pagination

<Aside type="note">
  La pagination n'est pas encore implémentée sur tous les endpoints. Actuellement, les endpoints de liste (missions, opérateurs) retournent **tous les résultats** dans un tableau JSON sans enveloppe de pagination. Consultez la documentation de chaque endpoint pour connaître le format exact de la réponse.
</Aside>

## Filtres et tri

Certains endpoints de liste supportent des filtres spécifiques à la ressource :

```bash
# Missions d'une date précise
curl "https://api.dispatchkit.io/api/v1/missions?date=2024-01-15" \
  -H "Authorization: Bearer {token}"
```

## Rate limiting

L'API est limitée à **1000 requêtes par minute** par token. Les headers de réponse indiquent votre consommation :

```
X-RateLimit-Limit: 1000
X-RateLimit-Remaining: 847
X-RateLimit-Reset: 1705315200
```

## Identifiants des ressources

Tous les identifiants sont des **UUID v4** standards (générés par PostgreSQL via `gen_random_uuid()`).

| Ressource | Format | Exemple |
|-----------|--------|---------|
| Mission | UUID v4 | `c3d4e5f6-a7b8-9012-cdef-123456789012` |
| Utilisateur / Opérateur | UUID v4 | `f1e2d3c4-b5a6-7890-abcd-ef1234567890` |
| Client | UUID v4 | `a1b2c3d4-e5f6-7890-abcd-ef1234567890` |
| Organisation | UUID v4 | `b2c3d4e5-f6a7-8901-bcde-f12345678901` |

## Versionnement

L'API est versionnée dans l'URL (`/api/v1`). Les changements non rétrocompatibles seront introduits dans une nouvelle version (`/api/v2`) avec une période de dépréciation d'au moins 6 mois.
